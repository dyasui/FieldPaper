{
  "hash": "249755aeb65be565e321968494c252d4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Ethnic Enclaves and the Legacy of Internment\nauthors:\n  - name: Dante Yasui\n    affiliation: The University of Oregon\n---\n\n\n\n# Intro\n\n![](figures/PioCrtInternmentMap.jpg){fig-align=\"center\"}\n\n\n## Research Question\n\n  * Did post-war relocation cause a permanent shift in the migration choices of Japanese Americans?\n\n---\n\n\n## Motivation\n\n  * Immigrant populations tend to concentrate near places of initial settlement\n    \n  * Integration/assimilation could be important for immigrant labor market outcomes\n    - [@damm_ethnic_2009]\n  \n  * Evidence for Canadian Japanese internment having persistant\neffect on spatial Japanese distribution \n  - [@chan_forced_2022]\n    \n\n## Initial Distribution of pre-war Japanese Population\n\n![](figures/county_JAmap.png){fig-align=\"center\"}\n\n\n## Assignment of Internees to Camps\n\n![](figures/WRAzonesmap.png){fig-align=\"center\"}\n\n---\n    \n# Data\n\n\n\n---\nname: data\n---\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n-- Attaching core tidyverse packages ------------------------ tidyverse 2.0.0 --\nv dplyr     1.1.4     v readr     2.1.5\nv forcats   1.0.0     v stringr   1.5.1\nv ggplot2   3.5.1     v tibble    3.2.1\nv lubridate 1.9.3     v tidyr     1.3.1\nv purrr     1.0.2     \n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\ni Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(ipumsr)\nlibrary(labelled)\nlibrary(geos)\nlibrary(data.table)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'data.table'\n\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n```\n\n\n:::\n:::\n\n\n## Population and Migration\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# NOTE: to be able to download data via the IPUMS API,\n# use `set_ipums_api_key()` with API key from https://account.ipums.org/api_keys\n# to be able to use the submit_extract pipeline below to query ipums servers\n#\n# Read more with:\n# vignette(\"ipums-api\")\n#------------------------------------------------------------------------------#\n# select census samples for ipums API -----\nmigration_samples <- get_sample_info(\"usa\") %>%\n  filter(str_detect(description, \n        '1940 1%|1950 1%|1960 5%|1970 Form 2 Metro|1980 1%|1990 1%')) %>%\n  select(name) %>% pull()\n\n# select variables -----\nvariables <- list(\n  \"YEAR\"     , \"PERWT\"    , \n  \"STATEFIP\" , \"STATEICP\" , \"COUNTYICP\" , \"METAREA\"  , \"CITY\"     , \n  \"MIGRATE5\" , \"MIGPLAC5\" , \"MIGRATE1\"  , \"MIGPLAC1\" ,\n  \"RACE\"     , \"BPL\"      ,  \"AGE\"       , \"SEX\" ,\n  \"EMPSTAT\"  , \"LABFORCE\" , \"INCWAGE\"   , \"INCTOT\"   , \"OCCSCORE\" \n  )\n\n# pipeline to create and download data extract using ipumsr -----\ndefine_extract_usa(description = \"census migration data for years 1940 through 1990\",\n                     samples = migration_samples,\n                     variables = variables) %>%\n  submit_extract() %>%\n  # use is_extract_ready() if you want to avoid R session from being occupied\n  wait_for_extract() %>%\n  download_extract(download_dir = \"data/census\")\n```\n:::\n\n\n\nFor long-run migration data,\nI use the Decennial Census data provided by the US Census Bureau via the \n[Integrated Public Use Microdata Series](https://usa.ipums.org/usa/index.shtml) [@ruggles_steven_ipums_2024].\nThe census samples for which county locations are available include the \n1940, 1950, 1980, and 1990 1% samples, the 1960 5% sample,\nand the 1970 Form 2 Metro 1% sample.\n\nFor the calculation of migration rates between counties, \nI define a migrant as someone who reports that they either\nmoved within the state, between states, or that they were abroad five years ago\n(or in the past 1 year for 1960 respondants). \nThis excludes people who report moving within the same house, \ndidn't report their previous location, or the location is unknown.\n\n\n## Geography\n\n### Historical County Borders\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncounty1990_shp_name <- get_metadata_nhgis(\"shapefiles\") %>%\n  filter(year == 1990,\n         geographic_level == 'County',\n         str_detect( basis, '^2008' )) %>% # 2008 TIGER/Lines basis\n  select(name) %>% pull()\n\ndefine_extract_nhgis(\n    description = \"NHGIS shapefile for 1990 county boundaries\",\n    shapefiles = \"us_county_1990_tl2008\" ) %>%\n    submit_extract() %>%\n    wait_for_extract() %>%\n    download_extract(download_dir = \"./data/maps/\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncounty1990_shp <- read_ipums_sf(\"data/maps/nhgis0018_shape/nhgis0018_shapefile_tl2008_us_county_1990.zip\") %>% \n  as.data.table() %>% \n  filter(STATENAM %notin% c('Alaska', 'Hawaii')) %>% \n  # need an extra zero to go from STATEFIPS to NHGISST\n  mutate(\n    id1990 = as.numeric(NHGISST) * 10000 + as.numeric(NHGISCTY) ,\n    geo = as_geos_geometry(geometry, crs=102003)\n    ) \n```\n:::\n\n\n\n<!-- I also use 1950 county boundaries derived from 2008 TIGER/line files -->\n<!-- dowloaded from [https://www.nhgis.org/data-availability#gis-files](NHGIS) -->\n<!-- [@manson_steven_national_2022]. -->\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Crosswalk file from Eckert, Gvirtz, Liang, and Peters (2020)\n# github repo link for replication data:\nurl <- \"https://raw.githubusercontent.com/liang-jack-a/EGLP_Crosswalk/master/Crosswalks/county_crosswalk_endyr_1990.csv\"\ncrosswalk <- read_csv(url) %>%\n  filter(Year %in% 1940:1980) %>% # 1990 counties don't appear as their own rows\n  mutate( # combine state and county codes into single id variable\n    id     = as.numeric(NHGISST) * 10000 + as.numeric(NHGISCTY),\n    id1990 = as.numeric(NHGISST_1990) * 10000 + as.numeric(NHGISCTY_1990)) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 95972 Columns: 17\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (8): NHGISST, NHGISCTY, STATENAM, NHGISNAM, NHGISST_1990, NHGISCTY_1990,...\ndbl (9): Year, ICPSRST, ICPSRCTY, area_base, ICPSRST_1990, ICPSRCTY_1990, ar...\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncrosswalk <- crosswalk %>% \n  bind_rows( # fill in rows for 1990 counties\n    crosswalk %>% \n      distinct(id1990, .keep_all = TRUE) %>% \n      mutate(\n        Year     = 1990,\n        NHGISST  = NHGISST_1990,\n        NHGISCTY = NHGISCTY_1990,\n        STATENAM = STATENAM_1990,\n        NHGISNAM = NHGISNAM_1990,\n        ICPSRST  = ICPSRST_1990,\n        ICPSRCTY = ICPSRCTY_1990,\n        area_base= NA,\n        area     = NA,\n        weight   = 1,\n      )\n  ) \n```\n:::\n\n\n\nAlthough most county borders did not change much in the second half of the 20th\nCentury, there were counties which split, merged, or had name changes which can \nmake cross-decade comparisons difficult.\nFor these reasons, I choose to standardize the set of counties in my analysis to\nthe set of counties as they appear in the year 1990.\nTo map historical county-level data to 1990 county definitions,\nI implement the crosswalk method by [@eckert_method_2020].\nThey overlay historical county boundary shapefiles from [https://www.nhgis.org/](NHGIS)\nonto county boundaries for a specific target year (in this case 1990).\nThe sub-areas created by these overlays are used to calculate a set of geographic weights\nwhich represent the fractions of a 1990 county's area which were within the geographic areas\nof counties as they appear in different decades (specifically the decades between and including 1940 to 1980).\nFor my analysis, I take the crosswalk weights from the example csv file for the end year 1990 \nwhich is published on the authors' \n[github repository](https://github.com/liang-jack-a/EGLP_Crosswalk/tree/master).\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(tidyverse)\ncensus_df <- read_csv(here::here(\"./data/migrations_crosswalked.csv\"), show_col_types = F)\nobsbyyear_tbl <- census_df %>% count(Year)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncountyyr_df <- \n right_join(crosswalk, census_df, \n            by = c(\"id1990\", \"Year\"), \n            relationship = \"many-to-many\") %>% \n  group_by(Year, id1990, STATENAM, NHGISNAM) %>% \n  summarise(across(starts_with(c(\"mig\",\"pop\")), ~ sum(.x * weight))) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n`summarise()` has grouped output by 'Year', 'id1990', 'STATENAM'. You can\noverride using the `.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncountyyr_df <- left_join(countyyr_df, county1990_shp, by = \"id1990\")\n\ncounty1940_df <- countyyr_df %>% filter(Year==1940)\n\n# plot(county1940_df$geo, col = pop_total)\n\ncounty_map <- ggplot(data = county1940_df) +\n  geom_sf(aes(geometry = geometry)) +\n  theme_void()\n\ncounty_map + \n  geom_sf(aes(geometry = geometry, fill = migratio_total), size = 0.1) +\n  scale_fill_viridis_c() \n```\n\n::: {.cell-output-display}\n![](main_files/figure-pdf/unnamed-chunk-1-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n\n\n### Camp Locations\n\nLocations for historical interment camp locations were archived by \n[Densho Encyclopedia](http://encyclopedia.densho.org/War_Relocation_Authority/#Planning_the_Camps)\nand downloaded in csv form via the \n[Behind Barbed Wires story project](https://www.arcgis.com/home/item.html?id=69183af8d45d4f46a9dc4eba99440891).\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ncamplocations_df <- read_csv(\"data/BehindBarbedWire_StoryMap/BehindBarbedWire_StoryMap_InternmentCampLocationsMap_Data.csv\") %>% \n  # I'm not sure what CRS the source is in, but this is the most common one\n  mutate(geo = geos_make_point(Longitude, Latitude)) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 10 Columns: 8\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (5): Internment Camp Name, Location, State, Opened, Closed\ndbl (2): Latitude, Longitude\nnum (1): Maximum Population\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n  # st_transform(., src = 4326, dst = 102003))\n\n# plot(county1990_shp$geo)\n# plot(camplocations_df$geo, col = \"red\", add= T)\n\ncounty_map + \n  geom_sf(data = camplocations_df, aes(geometry=geo), color = \"red\")\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nDon't know how to automatically pick scale for object of type <geos_geometry>.\nDefaulting to continuous.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Computation failed in `stat_sf()`.\nCaused by error in `UseMethod()`:\n! no applicable method for 'st_bbox' applied to an object of class \"geos_geometry\"\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](main_files/figure-pdf/read-camplocations-1.pdf){fig-pos='H'}\n:::\n:::\n\n\nI calculate the straight line distances in meters between each 1950 county centroid to each camp location in QGIS\nwith the `Distance Matrix` tool using the Standard (N x T) distance matrix setting.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# geos_distance(county1990_shp$geo, as_geos_geometry())\n```\n:::\n\n\n\n## Historical counties dataset\n\n\nAfter narrowing down to counties which can be observed in each census year\nand then translating the historical counties to 1990 county boundaries,\nI am left with \n3082 counties with observable migration rates in 1940,\n108 in 1950, \n410 in 1960, \n115 in 1970, \n254 in 1980, and\n290 in 1990.\n\nMy primary dataset is therefore a pooled-crossection with a total number of\n28 county-year level observations.\nEach observation represents an individual county at a given year in time\nif it had the same borders as it had in 1990.\n\nThe Census Bureau confidentiality standards state that public-use microdata will\ncannot show report locations with populations of less than 100,000 people.\n<!-- [@federal_committee_on_statistical_methodology_statistical_2005]. -->\nFor this reason, many sparsely-populated counties will be omitted from my sample\nbecause there are not enough observations for the Census to report locations of individuals living there.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Crosswalk file from Eckert, Gvirtz, Liang, and Peters (2020)\n# github repo link for replication data:\nurl <- \"https://raw.githubusercontent.com/liang-jack-a/EGLP_Crosswalk/master/Crosswalks/county_crosswalk_endyr_1990.csv\"\ncrosswalk <- read_csv(url) %>%\n  filter(Year %in% 1940:1980) %>% # 1990 counties don't appear as their own rows\n  mutate( # combine state and county codes into single id variable\n    id     = as.numeric(NHGISST) * 10000 + as.numeric(NHGISCTY),\n    id1990 = as.numeric(NHGISST_1990) * 10000 + as.numeric(NHGISCTY_1990)) \n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 95972 Columns: 17\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (8): NHGISST, NHGISCTY, STATENAM, NHGISNAM, NHGISST_1990, NHGISCTY_1990,...\ndbl (9): Year, ICPSRST, ICPSRCTY, area_base, ICPSRST_1990, ICPSRCTY_1990, ar...\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncrosswalk <- crosswalk %>% \n  bind_rows( # fill in rows for 1990 counties\n    crosswalk %>% \n      distinct(id1990, .keep_all = TRUE) %>% \n      mutate(\n        Year     = 1990,\n        NHGISST  = NHGISST_1990,\n        NHGISCTY = NHGISCTY_1990,\n        STATENAM = STATENAM_1990,\n        NHGISNAM = NHGISNAM_1990,\n        ICPSRST  = ICPSRST_1990,\n        ICPSRCTY = ICPSRCTY_1990,\n        area_base= NA,\n        area     = NA,\n        weight   = 1,\n      )\n  ) \n```\n:::\n\n::: {#cell-fig-comparesamplepops .cell}\n\n```{.r .cell-code .hidden}\n# record set of counties in sample with observable locations\ncounty_sample <- census_df %>% \n  select(Year, id1990) %>%\n  unite(ctyr_id, c(\"id1990\",\"Year\"), remove = TRUE) %>% \n  pull()\n\n# crosswalk historical county population tables from nhgis to 1990 counties\ncountypop_df <- read_csv(here::here(\"data/census/nhgis0019_csv/nhgis0019_ts_nominal_county.csv\")) %>%\n  mutate(id = as.numeric(STATENH)*10000 + as.numeric(COUNTYNH)) %>% \n  right_join(crosswalk, .,\n           by = c(\"id\", \"Year\"=\"YEAR\"),\n           relationship = \"many-to-many\") %>%\n  group_by(Year, id1990, STATENAM_1990, NHGISNAM_1990) %>%\n  summarise(pop = sum(A00AA * weight)) %>% \n  ungroup() %>% \n  unite(ctyr_id, c(\"id1990\",\"Year\"), remove = FALSE)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nRows: 18770 Columns: 10\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (8): GISJOIN, STATE, STATEFP, STATENH, COUNTY, COUNTYFP, COUNTYNH, NAME\ndbl (2): YEAR, A00AA\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n`summarise()` has grouped output by 'Year', 'id1990', 'STATENAM_1990'. You can override using the `.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\ncountypop_df <- countypop_df %>% \n  mutate(\n    insample = (ctyr_id %in% county_sample)\n  )\n\nggplot(data = countypop_df, aes(x = pop, fill = insample)) +\n  geom_density(alpha = 0.5) +\n  scale_x_log10() +\n  ggthemes::theme_pander()\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Removed 1 row containing non-finite outside the scale range\n(`stat_density()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![County-year level population distributions](main_files/figure-pdf/fig-comparesamplepops-1.pdf){#fig-comparesamplepops fig-pos='H'}\n:::\n:::\n\n\n\nThe average population of the census-year observations in my sample is\n\\ensuremath{1.3326856\\times 10^{5}} \nwhile the average population for crosswalked census-year observations outside my sample is\n\\ensuremath{3.9299349\\times 10^{4}}.\nThe fact that my sample is not fully representative of all county sizes\nwill be a challenge for the external validity of my findings to extrapolate my results to smaller counties for which I have less information on.\nHowever, @fig-comparesamplepops shows that two different densities of county-year populations observed in and out of the main sample\nhave similar shapes with the exception of a larger right-tail in the \nin-sample density plot. \nThis reflects the fact that counties with populations of greater than 100,000\nmeet the Census Bureau's confidentiality criteria, \nwhile data from smaller counties are subject to stricter confidentiality measures.\n\n\n\n\n## WRA first addresses\n* [*The Evacuated People: A Quantitative Descripton*]{.h} [@krug_evacuated_1946]\n  - Final WRA report on \"State and Post Office Address of First Destination by Nativity, Prior January 1, 1945 and January 1, 1945 and Later\" \n  - Digitized and uploaded by Cooper Thomas via [data.world](https://data.world/infinitecoop/japanese-internment-camps)\n\n### Map of Relocated Internees by City\n\n## WRA internees\n\n![](figures/wra-internee-cohorts.png)\n\n## IPUMS Census\n* Decennial Census Data for years 1940, 1950, 1960, 1970, 1980, and 1990\n  - Via IPUMS USA [@ruggles_steven_ipums_2024]\n\n![](figures/shareareaplot.png)\n\n## NHGIS geo\n\n--\n\n# Methods\n\n## immigration on dist to camps\n\n### within cont. US migration of japanese americans\n\n### new immigration from japan\n\n## individual-level characteristics vs internees?\n\n# Results\n# Conclusion\n",
    "supporting": [
      "main_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": null,
    "postProcess": false
  }
}