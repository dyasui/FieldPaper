---
name: data
---

## Population and Migration

For long-run migration data,
I use the Decennial Census data provided by the US Census Bureau via the 
[Integrated Public Use Microdata Series](https://usa.ipums.org/usa/index.shtml) [@ruggles_steven_ipums_2020].
The census samples for which county locations are available include the 
1940, 1950, 1980, and 1990 1% samples, the 1960 5% sample,
and the 1970 Form 1 Metro 1% sample.

For the calculation of migration rates between counties, 
I define a migrant as someone who reports that they either
moved within the state, between states, or that they were abroad five years ago
(or in the past 1 year for 1960 respondants). 
This excludes people who report moving within the same house, 
didn't report their previous location, or the location is unknown.


## Geography

Locations for historical interment camp locations were archived by 
[Densho Encyclopedia](http://encyclopedia.densho.org/War_Relocation_Authority/#Planning_the_Camps)
and downloaded in csv form via the 
[Behind Barbed Wires story project](https://www.arcgis.com/home/item.html?id=69183af8d45d4f46a9dc4eba99440891).

<!-- I also use 1950 county boundaries derived from 2008 TIGER/line files -->
<!-- dowloaded from [https://www.nhgis.org/data-availability#gis-files](NHGIS) -->
<!-- [@manson_steven_national_2022]. -->

Although most county borders did not change much in the second half of the 20th
Century, there were counties which split, merged, or had name changes which can 
make cross-decade comparisons difficult.
For these reasons, I choose to standardize the set of counties in my analysis to
the set of counties as they appear in the year 1990.
To map historical county-level data to 1990 county definitions,
I implement the crosswalk method by [@eckert_method_2020].
They overlay historical county boundary shapefiles from [https://www.nhgis.org/](NHGIS)
onto county boundaries for a specific target year (in this case 1990).
The sub-areas created by these overlays are used to calculate a set of geographic weights
which represent the fractions of a 1990 county's area which were within the geographic areas
of counties as they appear in different decades (specifically the decades between and including 1940 to 1980).
For my analysis, I take the crosswalk weights from the example csv file for the end year 1990 
which is published on the authors' 
[github repository](https://github.com/liang-jack-a/EGLP_Crosswalk/tree/master).

I calculate the straight line distances in meters between each 1950 county centroid to each camp location in QGIS
with the `Distance Matrix` tool using the Standard (N x T) distance matrix setting.

## Historical counties dataset

```{r}
library(tidyverse)
census_df <- read_csv(here::here("./data/migrations_crosswalked.csv"), show_col_types = F)
obsbyyear_tbl <- census_df %>% count(Year)
```

After narrowing down to counties which can be observed in each census year
and then translating the historical counties to 1990 county boundaries,
I am left with 
`r obsbyyear_tbl$n[1]` counties with observable migration rates in 1940,
`r obsbyyear_tbl$n[2]` in 1950, 
`r obsbyyear_tbl$n[3]` in 1960, 
`r obsbyyear_tbl$n[4]` in 1970, 
`r obsbyyear_tbl$n[5]` in 1980, and
`r obsbyyear_tbl$n[6]` in 1990.

My primary dataset is therefore a pooled-crossection with a total number of
`r length(census_df)` county-year level observations.
Each observation represents an individual county at a given year in time
if it had the same borders as it had in 1990.

The Census Bureau confidentiality standards state that public-use microdata will
cannot show report locations with populations of less than 100,000 people
[@federal_committee_on_statistical_methodology_statistical_2005].
For this reason, many sparsely-populated counties will be omitted from my sample
because there are not enough observations for the Census to report locations of individuals living there.

```{r}
#| label: get-crosswalk
# Crosswalk file from Eckert, Gvirtz, Liang, and Peters (2020)
# github repo link for replication data:
url <- "https://raw.githubusercontent.com/liang-jack-a/EGLP_Crosswalk/master/Crosswalks/county_crosswalk_endyr_1990.csv"
crosswalk <- read_csv(url) %>%
  filter(Year %in% 1940:1980) %>% # 1990 counties don't appear as their own rows
  mutate( # combine state and county codes into single id variable
    id     = as.numeric(NHGISST) * 10000 + as.numeric(NHGISCTY),
    id1990 = as.numeric(NHGISST_1990) * 10000 + as.numeric(NHGISCTY_1990)) 

crosswalk <- crosswalk %>% 
  bind_rows( # fill in rows for 1990 counties
    crosswalk %>% 
      distinct(id1990, .keep_all = TRUE) %>% 
      mutate(
        Year     = 1990,
        NHGISST  = NHGISST_1990,
        NHGISCTY = NHGISCTY_1990,
        STATENAM = STATENAM_1990,
        NHGISNAM = NHGISNAM_1990,
        ICPSRST  = ICPSRST_1990,
        ICPSRCTY = ICPSRCTY_1990,
        area_base= NA,
        area     = NA,
        weight   = 1,
      )
  ) 
```

```{r}
#| label: fig-comparesamplepops
#| fig-cap: "County-year level population distributions"
# record set of counties in sample with observable locations
county_sample <- census_df %>% 
  select(Year, id1990) %>%
  unite(ctyr_id, c("id1990","Year"), remove = TRUE) %>% 
  pull()

# crosswalk historical county population tables from nhgis to 1990 counties
countypop_df <- read_csv(here::here("data/census/nhgis0019_csv/nhgis0019_ts_nominal_county.csv")) %>%
  mutate(id = as.numeric(STATENH)*10000 + as.numeric(COUNTYNH)) %>% 
  right_join(crosswalk, .,
           by = c("id", "Year"="YEAR"),
           relationship = "many-to-many") %>%
  group_by(Year, id1990, STATENAM_1990, NHGISNAM_1990) %>%
  summarise(pop = sum(A00AA * weight)) %>% 
  ungroup() %>% 
  unite(ctyr_id, c("id1990","Year"), remove = FALSE)

countypop_df <- countypop_df %>% 
  mutate(
    insample = (ctyr_id %in% county_sample)
  )

ggplot(data = countypop_df, aes(x = pop, fill = insample)) +
  geom_density(alpha = 0.5) +
  scale_x_log10() +
  ggthemes::theme_pander()
```


The average population of the census-year observations in my sample is
`r countypop_df %>% filter(insample==TRUE) %>% summarise(pop = mean(pop, na.rm=TRUE)) %>% pull()` 
while the average population for crosswalked census-year observations outside my sample is
`r countypop_df %>% filter(insample==FALSE) %>% summarise(pop = mean(pop, na.rm=TRUE)) %>% pull()`.
The fact that my sample is not fully representative of all county sizes
will be a challenge for the external validity of my findings to extrapolate my results to smaller counties for which I have less information on.
However, @fig-comparesamplepops shows that two different densities of county-year populations observed in and out of the main sample
have similar shapes with the exception of a larger right-tail in the 
in-sample density plot. 
This reflects the fact that counties with populations of greater than 100,000
meet the Census Bureau's confidentiality criteria, 
while data from smaller counties are subject to stricter confidentiality measures.

